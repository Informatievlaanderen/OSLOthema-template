name: Check diff between template and current state
on: [push]

jobs:
  generate-diff:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest]
        node-version:
          - 18.x
    steps:
      - name: Checkout source branch
        uses: actions/checkout@v4
        with:
          repository: Informatievlaanderen/OSLOthema-template
          ref: standaardenregister
          path: source

      - name: Clone other repository
        uses: actions/checkout@v4
        with:
          # Dynamic reference to the active repository so that it works immediately when creating a new thema repo
          # repository: ${{ github.repository }}
          repository: Informatievlaanderen/OSLOthema-voorwaarden-dienstverlening
          ref: standaardenregister
          path:
            target
            # Extra step to debug the file structure
      - name: List file structure of source dir
        shell: bash
        run: |
          ls source
      - name: List file structure of target dir
        shell: bash
        run: |
          ls target
      - name: Create diff
        shell: bash
        run: |
          git diff --no-index  --name-only source target
